# Fluux Agent — Configuration
#
# Copy this file to agent.toml and adapt the values.
# Environment variables are supported: ${VAR_NAME}

# --- Connection mode: "component" (XEP-0114) or "client" (C2S) ---

# Option A: External component (XEP-0114)
[server]
host = "localhost"
port = 5275
mode = "component"
component_domain = "agent.localhost"
component_secret = "${AGENT_SECRET}"

# Option B: C2S client (connect as a regular XMPP user)
# [server]
# host = "localhost"
# port = 5222
# mode = "client"
# jid = "bot@localhost"
# password = "${BOT_PASSWORD}"
# resource = "fluux-agent"
# tls_verify = false  # set to false for self-signed certs (dev)

[llm]
# LLM provider: "anthropic" or "ollama"
provider = "anthropic"
# Model to use
model = "claude-haiku-4-5-20250110"
# API key (use an environment variable!)
api_key = "${ANTHROPIC_API_KEY}"
# Max tokens per request
max_tokens_per_request = 4096

# Alternative: Ollama (local models)
# [llm]
# provider = "ollama"
# model = "llama3.2"
# host = "http://localhost:11434"  # default; omit to use localhost
# max_tokens_per_request = 4096

[agent]
# Agent display name
name = "Fluux Agent"
# JIDs allowed to talk to the agent
# Use "*" to allow everyone (not recommended in production)
allowed_jids = [
    "admin@localhost",
]
# Allowed sender domains (cross-domain message rejection).
# If omitted, only the agent's own domain is accepted (safe default).
# Uncomment to allow federation from specific domains:
# allowed_domains = ["localhost", "partner.example.com"]
# Use ["*"] to allow all domains (not recommended in production)

[memory]
# Memory backend: "markdown" (human-readable files, OpenClaw-compatible)
backend = "markdown"
# Base directory for memory files (one subdirectory per user JID)
path = "./data/memory"

# --- Multi-User Chat (MUC, XEP-0045) ---
# The agent joins these rooms on connect and responds to mentions.
# Each room gets its own isolated memory directory (room JID as key).

# [[rooms]]
# jid = "lobby@conference.localhost"
# nick = "fluux-agent"       # Bot's nickname in the room (default: "fluux-agent")

# [[rooms]]
# jid = "dev@conference.localhost"
# nick = "fluux-agent"

# --- Skills ---
# Skills extend the agent's capabilities. The LLM can invoke these as tools.
# Each skill section is optional — if absent, the skill is not registered.

# [skills.web_search]
# provider = "tavily"               # "tavily" or "perplexity"
# api_key = "${TAVILY_API_KEY}"     # Get your key at https://tavily.com
# max_results = 5                   # Number of results (default: 5, Tavily only)

# Alternative: Perplexity Sonar
# [skills.web_search]
# provider = "perplexity"
# api_key = "${PERPLEXITY_API_KEY}" # Get your key at https://perplexity.ai
# model = "sonar"                   # "sonar" (default) or "sonar-pro"

# --- Future sections (v0.2+) ---

# [sandbox]
# enable_landlock = true
# enable_seccomp = true
# wasm_fuel_limit = 1_000_000
# wasm_memory_max_mb = 64

# [proactive]
# enable = true
#
# [[proactive.jobs]]
# skill = "email-summary"
# cron = "0 7 * * 1-5"
# notify = "admin@localhost"
